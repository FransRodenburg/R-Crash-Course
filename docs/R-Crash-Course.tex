% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={R Crash Course},
  pdfauthor={Dr.~F.J. Rodenburg   © 2020--2021 Universiteit Leiden},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}

\title{R Crash Course}
\author{Dr.~F.J. Rodenburg © 2020--2021 Universiteit Leiden}
\date{}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{introduction}{%
\chapter*{Introduction}\label{introduction}}
\addcontentsline{toc}{chapter}{Introduction}

This one-week course will improve your programming to the level required to pass \href{https://fransrodenburg.github.io/General-Research-Skills/}{General Research Skills}. Each day consists of about half an hour of explanation and 1--2 hours of assignments.

\hypertarget{structure-of-this-course}{%
\section*{Structure of This Course}\label{structure-of-this-course}}
\addcontentsline{toc}{section}{Structure of This Course}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \protect\hyperlink{installation}{Installation and \texttt{swirl}}
\item
  \protect\hyperlink{base-graphics}{Base graphics using \texttt{plot}}
\item
  \protect\hyperlink{ggplot2}{Specialized graphics using \texttt{ggplot2}}
\item
  \protect\hyperlink{data-manipulation}{Reading and manipulating data}
\item
  \protect\hyperlink{MWE}{Creating a Minimal Working Example}
\end{enumerate}

The \texttt{swirl} assignment on day 1 is a great way to get used to the basic syntax (like remembering to close brackets). But if we build up your programming skill all the way from the fundamentals, explaining every step along the way, there is no way you could do anything remotely useful after only a week. Also, it would be excruciatingly boring.

Hence, every day after the first, we will begin with an example of something useful you can do in R. I will explain how it works and then it is your job to edit the code provided and make it do something else. In the beginning that may feel a lot like you are just copy-pasting the example. But the more you practice, the more you will feel comfortable actually changing code. At some point, you may even know a fair few functions by heart, but even if you don't, always keep in mind: It is perfectly fine to search online.

Learning a programming language is similar to learning any other language: You could learn long lists of words and endless rules about grammar (as is unfortunately how language is usually taught in school), but this will never make you fluent in a language, let alone in one week. To speak the language, it is \emph{much} more efficient to start by learning some useful phrases and building your knowledge from there. The same goes with programming in R: If you know how to make a certain figure, then who cares that you don't know exactly how it works, or what exactly happens under the hood? If you are able to adjust the code to work with new data, then you can make that figure for any data set!

\hypertarget{examination}{%
\section*{Examination}\label{examination}}
\addcontentsline{toc}{section}{Examination}

This course has no credits, exam or grade. However, during Of course, the things you pick up during this course can be used during the graded assignment of \href{https://fransrodenburg.github.io/General-Research-Skills/}{General Research Skills}, which is also in R.

In the live version of this course, if time permits, we will go over some student solutions at the end of each day and discuss what works, what doesn't and why.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\includegraphics[width=0.20833in,height=0.20833in]{figures/underconstruction.png} This course is a work in progress. Please check back later for updates. For students at Leiden University, always consult Brightspace for the latest information on the schedule, the course material and the exam.

\hypertarget{installation}{%
\chapter{\texorpdfstring{Installation \& \texttt{swirl}}{Installation \& swirl}}\label{installation}}

The goal for this day is to install and setup RStudio and to verify your installation is working correctly.

Total video length: 20 min.\\
Exercise length: 30--90 min.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

In order for you not to get stuck on errors, it is vital that RStudio is installed correctly. I recommend a clean install even if you already have the software.

\hypertarget{installation-guide}{%
\section{Installation Guide}\label{installation-guide}}

Watch the video below and install RStudio:

\begin{verbatim}
## PhantomJS not found. You can install it with webshot::install_phantomjs(). If it is installed, please make sure the phantomjs executable can be found via the PATH variable.
\end{verbatim}

Note: TinyTeX is not required for this course. All you need is a working version of RStudio, and to be able to knit to HTML.

\hypertarget{what-is-rstudio}{%
\section{What is RStudio?}\label{what-is-rstudio}}

Watch the video below and change the options as suggested (e.g.~disable inline output):

\hypertarget{exercises}{%
\section{Exercises}\label{exercises}}

If you are following the live version of the course, make sure you address installation issues today. From day 2 onward, you are expected to have a working version of RStudio. You can ask any of the assistants or teachers for help.

Once you have RStudio installed, start with \texttt{swirl}:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Install \texttt{swirl} as explained in the video below (\href{https://youtu.be/eKKil5iyxLM?t=148}{last part});
\item
  Choose the R Programming course;
\item
  Complete chapters 1, 2, 4, 7 \& 8. Each take about 5--15 minutes.
\end{enumerate}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

If you have time left and want to prepare for the rest of the course, please try running the following in the \href{https://youtu.be/AHAR7j-IUOw?t=133}{console} (copy it, paste it in the console and press enter):

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"COVID19"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"ggplot2"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"rgeos"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"rnaturalearth"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"rnaturalearthdata"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"sf"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

These packages will be used during the rest of the course. If you have installation problems, we can address them early on.

\hypertarget{base-graphics}{%
\chapter{Base Graphics}\label{base-graphics}}

Producing figures using the built-in functions in R.

Total video length: 9 min.\\
Exercise length: 30--60 min.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

An easy way to see how R works is by making plots.

\hypertarget{exercise-easy}{%
\section{Exercise (easy)}\label{exercise-easy}}

Today is almost certainly someone's birthday. Let's make them a cake!

Below is an example of a simple drawing in base R:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\AttributeTok{xlim =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{10}\NormalTok{), }\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{10}\NormalTok{), }\AttributeTok{xlab =} \StringTok{""}\NormalTok{, }\AttributeTok{ylab =} \StringTok{""}\NormalTok{, }\AttributeTok{las =} \DecValTok{1}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{)}

\CommentTok{\# Level 1}
\DocumentationTok{\#\# Horizontal lines}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{9}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{9}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{3}\NormalTok{))}
\DocumentationTok{\#\# Vertical lines}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{))}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{9}\NormalTok{, }\DecValTok{9}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{))}

\CommentTok{\# Level 2}
\DocumentationTok{\#\# Horizontal line}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{8}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{5}\NormalTok{))}
\DocumentationTok{\#\# Vertical lines}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{))}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{8}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{))}

\CommentTok{\# Level 3}
\DocumentationTok{\#\# Horizontal lines}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{7}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{7}\NormalTok{, }\DecValTok{7}\NormalTok{))}
\DocumentationTok{\#\# Vertical lines}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{3}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{))}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{7}\NormalTok{, }\DecValTok{7}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{))}

\CommentTok{\# Candles}
\NormalTok{k }\OtherTok{\textless{}{-}} \DecValTok{3}                             \CommentTok{\# number of candles}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\FloatTok{3.5}\NormalTok{, }\FloatTok{6.5}\NormalTok{, }\AttributeTok{length.out =}\NormalTok{ k) }\CommentTok{\# position of the candles}
\NormalTok{h }\OtherTok{\textless{}{-}} \FloatTok{0.7}                           \CommentTok{\# height of the candles}
\FunctionTok{segments}\NormalTok{(}\AttributeTok{x0 =}\NormalTok{ x, }\AttributeTok{x1 =}\NormalTok{ x, }\AttributeTok{y0 =} \FunctionTok{rep}\NormalTok{(}\DecValTok{7}\NormalTok{, k), }\AttributeTok{y1 =} \FunctionTok{rep}\NormalTok{(}\DecValTok{7} \SpecialCharTok{+}\NormalTok{ h, k), }\AttributeTok{lwd =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=28in]{figures/cake}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Create a \href{https://youtu.be/2Sovzf6lVRo?t=280}{new R markdown file} and copy the script to a \href{https://youtu.be/AHAR7j-IUOw?t=358}{new R chunk}.
\item
  Run the entire chunk using the green play button on the top right of the chunk. This will generate the figure.
\item
  To see which line does what, run each line from top to bottom by clicking anywhere in the first line of code and pressing CTRL+Enter (Windows) or Command+Enter (MacOS). If this does not work, check the following:

  \begin{itemize}
  \tightlist
  \item
    Do you have \href{https://youtu.be/AHAR7j-IUOw?t=110}{inline output disabled}? Inline output may look convenient, but it usually causes more problems than it solves.
  \item
    Did you run the code in order?\footnote{The function \texttt{lines} adds a line to an existing plot. This is only possible if you run \texttt{plot} first, so run the code in order, from top to bottom.}
  \end{itemize}
\item
  Now that you have seen what each line does, change the script to render 5 candles instead of 3.
\item
  Can you change the code to add a layer to the cake? \emph{(You may have to make the other layers smaller, or move the candles up.)}
\end{enumerate}

\hypertarget{exercise-medium}{%
\section{Exercise (medium)}\label{exercise-medium}}

Below is a video on how to read help files as a starting point for this part:

Alternatively, look for explanations online. This might feel like cheating, but getting good at searching how to do things in R is actually a valuable skill.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Using \texttt{polygon}, color your layered cake with at least three different colors. You can view the help file by typing \texttt{?polygon} in the \href{https://youtu.be/AHAR7j-IUOw?t=133}{console} and pressing enter.
\item
  Now that everything is in place, let's add the title ``Happy Birthday'' and hide the axes. It is up to you to find out how, using whatever resource you want.
\end{enumerate}

\hypertarget{exercise-hard}{%
\section{Exercise (hard)}\label{exercise-hard}}

Now let's add sprinkling to the cake. We could tell R exactly where to draw the sprinkling, but nobody sprinkles like that. So let's make it a bit more realistic:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Use the function \texttt{runif} to randomly draw \(x\)-positions for the candles from a uniform distribution. Look up how to use the function by entering \texttt{?runif} in the console, or by searching online.
\item
  Every time you run the script, a new set of random coordinates will be chosen for your sprinkling. To make your cake reproducible, set a seed with the \texttt{set.seed} function. You can search online, or in the help files how this function works, and where you should place it in your script.
\item
  If you have time left, personalize your cake with base R functions however you see fit!
\end{enumerate}

\hypertarget{exercise-swirl}{%
\section{\texorpdfstring{Exercise (\texttt{swirl})}{Exercise (swirl)}}\label{exercise-swirl}}

Done drawing your cake? Want a bit more explanation of how base graphics actually work? Complete the \href{https://youtu.be/eKKil5iyxLM?t=148}{\texttt{swirl} R Programming} course, chapter 15.

\hypertarget{hall-of-fame}{%
\section*{Hall of Fame}\label{hall-of-fame}}
\addcontentsline{toc}{section}{Hall of Fame}

The best looking cake in R, using only base R functions will be displayed here for future visitors! Your name will not be included unless you consent.

\hypertarget{r-crash-course-2022}{%
\subsection*{R Crash Course (2022)}\label{r-crash-course-2022}}
\addcontentsline{toc}{subsection}{R Crash Course (2022)}

\includegraphics[width=28in]{figures/R2022cake}

Watch the discussion \href{https://youtu.be/uXfoIKguqME}{here}.

Download the source code \href{files/cake-winner-R-2022.Rmd}{here}.

\hypertarget{advanced-statistics-2021}{%
\subsection*{Advanced Statistics (2021)}\label{advanced-statistics-2021}}
\addcontentsline{toc}{subsection}{Advanced Statistics (2021)}

\includegraphics[width=28in]{figures/AS2022cake}

Watch the discussion \href{https://youtu.be/ERXp51uHp2w}{here}.

Download the source code \href{files/cake-winner-AS-2021.Rmd}{here}.

\hypertarget{ggplot2}{%
\chapter{\texorpdfstring{Graphics with \texttt{ggplot2}}{Graphics with ggplot2}}\label{ggplot2}}

A demonstration of one of the many specialized plotting routines offered by \texttt{ggplot2}.

Total video length: \ldots{} min.\\
Exercise length: 30--90 min.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Can you plot the number of COVID-19 infections across the world on a specific day using just \texttt{plot}, \texttt{lines}, \texttt{points}, \texttt{text} and \texttt{polygon}? Of course\ldots{} but it would probably take a very long time. If you install the following specialized packages:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"COVID19"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"ggplot2"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"rgeos"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"rnaturalearth"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"rnaturalearthdata"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"sf"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Here is how you could do that with \texttt{ggplot2}:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load package required for easy access to COVID{-}19 data}
\FunctionTok{library}\NormalTok{(}\StringTok{"COVID19"}\NormalTok{)}

\CommentTok{\# Load packages required for easy access to Earth data}
\FunctionTok{library}\NormalTok{(}\StringTok{"rnaturalearth"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(}\StringTok{"rnaturalearthdata"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(}\StringTok{"sf"}\NormalTok{)}

\CommentTok{\# Load ggplot2 and set background to white}
\FunctionTok{library}\NormalTok{(}\StringTok{"ggplot2"}\NormalTok{)}
\FunctionTok{theme\_set}\NormalTok{(}\FunctionTok{theme\_bw}\NormalTok{())}

\CommentTok{\# Load Earth data from rnaturalearthdata package}
\NormalTok{Earth }\OtherTok{\textless{}{-}} \FunctionTok{ne\_countries}\NormalTok{(}\AttributeTok{scale =} \StringTok{"medium"}\NormalTok{, }\AttributeTok{returnclass =} \StringTok{"sf"}\NormalTok{)}

\CommentTok{\# Load COVID{-}19 data for a specific date}
\NormalTok{COVID19 }\OtherTok{\textless{}{-}} \FunctionTok{covid19}\NormalTok{()}
\NormalTok{maxc    }\OtherTok{\textless{}{-}} \FunctionTok{max}\NormalTok{(COVID19}\SpecialCharTok{$}\NormalTok{confirmed, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\CommentTok{\# maximum number of cases}
\NormalTok{date    }\OtherTok{\textless{}{-}} \StringTok{"2021{-}06{-}30"}
\NormalTok{Cases   }\OtherTok{\textless{}{-}}\NormalTok{ COVID19[COVID19}\SpecialCharTok{$}\NormalTok{date }\SpecialCharTok{==}\NormalTok{ date, ]}

\CommentTok{\# Data cleaning}
\NormalTok{countries                               }\OtherTok{\textless{}{-}}\NormalTok{ Cases}\SpecialCharTok{$}\NormalTok{administrative\_area\_level\_1}
\NormalTok{countries[countries }\SpecialCharTok{==} \StringTok{"United States"}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{"United States of America"}
\NormalTok{countries[countries }\SpecialCharTok{==} \StringTok{"Korea, South"}\NormalTok{]  }\OtherTok{\textless{}{-}} \StringTok{"South Korea"}
\NormalTok{countries[countries }\SpecialCharTok{==} \StringTok{"Cote d\textquotesingle{}Ivoire"}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{"Ivory Coast"}

\CommentTok{\# Match the confirmed cases to the list of countries in the Earth data}
\NormalTok{wh          }\OtherTok{\textless{}{-}} \FunctionTok{match}\NormalTok{(Earth}\SpecialCharTok{$}\NormalTok{admin, countries)}
\NormalTok{Earth}\SpecialCharTok{$}\NormalTok{Cases }\OtherTok{\textless{}{-}}\NormalTok{ Cases}\SpecialCharTok{$}\NormalTok{confirmed[wh]}

\CommentTok{\# Plot the data}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ Earth) }\SpecialCharTok{+} \FunctionTok{geom\_sf}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{fill =}\NormalTok{ Cases)) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_viridis\_c}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, maxc), }\AttributeTok{option =} \StringTok{"plasma"}\NormalTok{, }\AttributeTok{trans =} \StringTok{"sqrt"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Confirmed infections on"}\NormalTok{, date))}
\end{Highlighting}
\end{Shaded}

Provided you have the latest version of R installed and the required packages were installed correctly, this will return the following:

\includegraphics[width=28in]{figures/COVIDEarth}

Using less than 50 lines of code, we now have a script that generates a world map colored by the number of infections on a particular day.

\hypertarget{exercises-1}{%
\section{Exercises}\label{exercises-1}}

If you get stuck on any of the exercises, you can watch the video below to get unstuck. In case of installation problems, contact one of the supervisors or assistants, or work together with a student who has successfully installed the packages.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Install the required packages and run the script to reproduce the figure.
\item
  Look at the legend. What does ``3e+07'' mean?
\item
  Read through the script. Can you change the figure to show the number of infections one month earlier? \emph{(Hint: Only one line in the code needs to be changed.)}
\item
  Delete \texttt{,\ trans\ =\ "sqrt"} from the script and run it again. What did this part do, and why would that be desirable? \emph{(You may restore the original script after this.)}
\item
  Delete the entire second to last line from the script. What did this line do? \emph{(You may restore the original script after this.)}
\item
  Essentially, \texttt{ggplot} works like this: \texttt{ggplot(dataset)\ +\ whattoshow()\ +\ extraoption1()\ +\ extraoption2\ +\ ...} Add the following to the \texttt{ggplot} chain in the script: \texttt{+\ coord\_sf(xlim\ =\ c(-10,\ 35),\ ylim\ =\ c(35,\ 70))} Run the script again. What does this do?
\item
  Can you change the \texttt{xlim} and \texttt{ylim} values from the previous question to center the map around Africa?
\item
  Go to the \href{https://github.com/sjmgarnier/viridis/\#the-color-maps}{github page} for the \texttt{viridis} package. What is the point of this package?
\item
  Can you change the \texttt{ggplot} part of our script to use a different color scheme? \emph{(Hint: We are already using one of the viridis color schemes, so you only have to change something, not add anything new.)}
\item
  If you click on \texttt{Earth} in the \href{https://youtu.be/AHAR7j-IUOw?t=162}{environment pane}, or if you run \texttt{View(Earth)} in the \href{https://youtu.be/AHAR7j-IUOw?t=133}{console}, you can see all the variables stored in the \texttt{Earth} data set. Can you change the original script to show the population estimates instead of the number of infections?
\end{enumerate}

\textbf{{[}video explaining the script to be included{]}}

\hypertarget{extra-data-cleaning}{%
\section{Extra: Data Cleaning (*)}\label{extra-data-cleaning}}

\emph{If you have time left, you can try and complete the additional exercises here.}

The COVID-19 and Earth data sets use different names for countries. So how did I know what names to replace with what?

You could simply print both lists of countries and manually look for names that are written differently in both data sets:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Country names in the Earth data set}
\NormalTok{Earth}\SpecialCharTok{$}\NormalTok{admin}

\CommentTok{\# Country names in the COVID{-}19 data set}
\NormalTok{countries}
\end{Highlighting}
\end{Shaded}

But these commands will return lists of over 200 countries\ldots{} A much easier way is to simply look at which countries were unavailable after the matching step. For example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{countries }\OtherTok{\textless{}{-}}\NormalTok{ Cases}\SpecialCharTok{$}\NormalTok{administrative\_area\_level\_1}
\NormalTok{wh        }\OtherTok{\textless{}{-}} \FunctionTok{match}\NormalTok{(Earth}\SpecialCharTok{$}\NormalTok{admin, countries)}
\NormalTok{Earth}\SpecialCharTok{$}\NormalTok{admin[}\FunctionTok{is.na}\NormalTok{(wh)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "Aruba"                                   
##  [2] "Anguilla"                                
##  [3] "Aland"                                   
##  ...  (49 countries omitted for brevity)                              
## [53] "United States of America"                
## [54] "Vatican"                                 
## [55] "British Virgin Islands"                  
## [56] "United States Virgin Islands"            
## [57] "Wallis and Futuna"
\end{verbatim}

This gives us a list of \emph{only} the countries in the \texttt{Earth} data set that were \emph{not} matched. Here we see that, for instance, \texttt{"United\ States\ of\ America"} was not matched to the COVID-19 data, even though we know there were large number of cases in the US.

The next step is to see how this country is called in the other data set. Again, you could just look at all the names in the variable \texttt{countries}, but how about we only check countries which name contains a capital letter ``U'':

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Countries in the COVID{-}19 data set with a capital letter U}
\NormalTok{countries[}\FunctionTok{grep}\NormalTok{(}\StringTok{"U"}\NormalTok{, countries)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "United Kingdom"           "Virgin Islands, U.S."    
## [3] "United States of America" "Uruguay"                 
## [5] "Uganda"                   "Uzbekistan"              
## [7] "United Arab Emirates"     "Ukraine"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Countries in the Earth data set with a capital letter U}
\NormalTok{Earth}\SpecialCharTok{$}\NormalTok{admin[}\FunctionTok{grep}\NormalTok{(}\StringTok{"U"}\NormalTok{, Earth}\SpecialCharTok{$}\NormalTok{admin)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "United Arab Emirates"         "United Kingdom"              
## [3] "United Republic of Tanzania"  "Uganda"                      
## [5] "Ukraine"                      "Uruguay"                     
## [7] "United States of America"     "Uzbekistan"                  
## [9] "United States Virgin Islands"
\end{verbatim}

Here we see the problem: In the COVID-19 data set, the US is called \texttt{"United\ States"}, whereas in the \texttt{Earth} data set it is called \texttt{"United\ States\ of\ America"}.

The solution is to overwrite the name so they are both the same:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{countries[countries }\SpecialCharTok{==} \StringTok{"United States"}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{"United States of America"}
\end{Highlighting}
\end{Shaded}

And like that, you can check all the unmatched countries for perhaps other names they might be known by.

Here is another example:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Countries containing "Congo" in the COVID{-}19 data set}
\NormalTok{countries[}\FunctionTok{grep}\NormalTok{(}\StringTok{"Congo"}\NormalTok{, countries)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Congo"                                
## [2] "Congo, the Democratic Republic of the"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Countries containing "Congo" in the Earth data set}
\NormalTok{Earth}\SpecialCharTok{$}\NormalTok{admin[}\FunctionTok{grep}\NormalTok{(}\StringTok{"Congo"}\NormalTok{, Earth}\SpecialCharTok{$}\NormalTok{admin)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Democratic Republic of the Congo" "Republic of Congo"
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  As you can see above, the two Congos have different names in either data set. Read the original script carefully. Add what you think is necessary to color the two Congos as well. To see if it works, simply run the script again to produce the (new) figure.
\item
  Using the method described above, can you color any other countries which are now grey? \emph{(Hint: Some countries do not have any data on confirmed cases, like Turkmenistan and North Korea. You can leave these uncolored.)}
\end{enumerate}

\hypertarget{data-manipulation}{%
\chapter{Reading \& Manipulating Data}\label{data-manipulation}}

An introduction to storing and converting data using the tidy format.

Total video length: 4 min.\\
Exercise length: 30--90 min.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{reading-data}{%
\section{Reading Data}\label{reading-data}}

There are many ways to read data into R. A simple method is explained in the video below:

\hypertarget{what-is-tidy-data}{%
\section{What Is Tidy Data?}\label{what-is-tidy-data}}

A standardized way to store data is by having \textbf{rows represent observations} and \textbf{columns represent variables}.

For example, take a look at the first few rows of the \texttt{iris} data set:

\label{tab:unnamed-chunk-20}Tidy data. Every row is a single flower. Every column is a single variable.

Sepal.Length

Sepal.Width

Petal.Length

Petal.Width

Species

5.1

3.5

1.4

0.2

setosa

4.9

3.0

1.4

0.2

setosa

4.7

3.2

1.3

0.2

setosa

4.6

3.1

1.5

0.2

setosa

5.0

3.6

1.4

0.2

setosa

5.4

3.9

1.7

0.4

setosa

\hypertarget{what-is-untidy-data}{%
\section{What Is Untidy Data?}\label{what-is-untidy-data}}

Sometimes it is tempting to use a different format. For example, here are the first few rows of a fictional qPCR data set performed in triplicates:

\label{tab:unnamed-chunk-21}Untidy data. A single row contains three different experimental observations.

Gene

Treatment

Ct value in exp. 1

Ct value in exp. 2

Ct value in exp. 3

A

control

22.8

16.0

17.2

B

control

22.2

15.7

19.5

C

control

23.0

20.4

23.7

D

control

14.5

18.9

18.9

E

control

17.6

22.2

17.5

A

ADH-/-

20.8

15.6

20.5

This may look like a more intuitive way to store your data, but most statistical software will not know what to do with it. Every row should contain a single gene's C\(_t\)-value from a single replicate. You can view the correct way to store it \href{https://docs.google.com/spreadsheets/d/1zBw0JX1JqALqF7m1CLQp4ojd1LUDoYHxnc6xIUYQVYY/}{here}.

Storing data in tidy format will greatly simplify analysis and almost everything we use in the \href{https://fransrodenburg.github.io/General-Research-Skills/}{GRS course} expects data to be in this format.

\hypertarget{exercise-easy-1}{%
\section{Exercise (easy)}\label{exercise-easy-1}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Watch the \href{https://youtu.be/BGUqZc-Pb8w}{video} on how to read data in R;
\item
  Download \href{data/humanheight.xlsx}{this Excel file};
\item
  Read the data into R as explained in step 1;
\item
  Convert the data set to tidy format using R code.
\end{enumerate}

There are different ways to complete this exercise. For example you could use the dollar sign (\texttt{\$}) or square brackets (\texttt{{[}\ ,\ {]}}) to indicate which column you want.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  Run a \(t\)-test to compare male and female height. See the help page for \texttt{t.test}. If you don't remember which \(t\)-test to use when, you may use the default;
\item
  Report your conclusion at a significance level of \(0.05\).
\end{enumerate}

HINT: The following are useful functions you might use for this: \texttt{c} (combine/concatenate), \texttt{rep} (repeat/replicate), \texttt{rbind} (rowbind), \texttt{cbind} (column bind). Use the help files, or Google if needed to find out how they work.

\hypertarget{exercise-medium-1}{%
\section{Exercise (medium)}\label{exercise-medium-1}}

The following \href{https://docs.google.com/spreadsheets/d/1zBw0JX1JqALqF7m1CLQp4ojd1LUDoYHxnc6xIUYQVYY/}{Google Sheets file} contains shows three versions of the same data set. The tab ``tidy'' is how I wish people sent me data. The tab ``untidy'' is what students often send me after at least trying to put it in the right format. The tab ``headache'' is closer to what people send me for consultancy.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Open the \href{https://docs.google.com/spreadsheets/d/1zBw0JX1JqALqF7m1CLQp4ojd1LUDoYHxnc6xIUYQVYY/}{Google Sheets file};
\item
  Download the ``untidy'' tab as a .csv file and read it into R;
\item
  Convert the file to tidy format;
\item
  Compare the resulting data frame with the ``tidy'' tab, to see if you got it right.
\end{enumerate}

HINT: The following are useful functions: \texttt{c} (combine/concatenate), \texttt{rep} (repeat/replicate), \texttt{rbind} (rowbind), \texttt{cbind} (column bind). Use the help files, or Google if needed to find out how they work.

\hypertarget{exercise-hard-1}{%
\section{Exercise (hard)}\label{exercise-hard-1}}

These two toy examples are very small data sets, so you might argue that it would be simpler to just fix them in Excel (I wouldn't disagree). However, if these were several dozen, or even hundreds of genes, then copy-pasting is dangerous, error-prone business.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Open the \href{https://docs.google.com/spreadsheets/d/1zBw0JX1JqALqF7m1CLQp4ojd1LUDoYHxnc6xIUYQVYY/}{Google Sheets file};
\item
  Download the ``headache'' tab as a .csv file and read it into R;
\item
  Convert the file to tidy format;
\item
  Compare the resulting data frame with the ``tidy'' tab, to see if you got it right;
\item
  Using the internet and any other resource you like, try plotting the different gene/treatment combinations in a single plot;
\item
  Bonus points if you can complete this exercise without developing a headache.
\end{enumerate}

\hypertarget{MWE}{%
\chapter{Debugging}\label{MWE}}

What do you do when your script returns a warning or error? Where do you find relevant information? How do you write a good question about programming with a minimal working example?

Total video length: \ldots{} min.\\
Exercise length: \ldots--\ldots{} min.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Getting stuck on a programming problem can be very frustrating. A minimal working example (MWE) is a script that contains \textbf{only} the necessary code and data for others to reproduce your error. If you add an MWE to your question, you are just about guaranteed to get better, and quicker answers to your coding questions.

\hypertarget{useful-information}{%
\section{Useful information:}\label{useful-information}}

\begin{itemize}
\tightlist
\item
  \texttt{dput}: Use this function save your data set into code. If someone runs this code, the output will be your data set. Try for instance \texttt{dput(iris)}.
\item
  \texttt{set.seed}: Use this function before you simulate data to initialize the random number generator. Anyone who runs your code with the same seed as you will end up with exactly the same data.
\item
  \href{http://web.stanford.edu/class/cs109l/unrestricted/resources/google-style.html}{Google's (old) R style guide}.\footnote{Their new style guide focuses on the \texttt{tidyverse}. The \texttt{tidyverse} is essentially a way to make code look `cleaner', but for an absolute beginner in R, it is another layer of complexity, as you will still need to use base R code in between. Hence why it is not a part of this course.}
\item
  \ldots{}
\end{itemize}

\hypertarget{self-test}{%
\chapter*{Self-Test}\label{self-test}}
\addcontentsline{toc}{chapter}{Self-Test}

Test your R knowledge by answering the following questions.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\ldots{}

\end{document}
